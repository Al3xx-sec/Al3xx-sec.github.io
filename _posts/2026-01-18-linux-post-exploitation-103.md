---
title: "Linux Post-Exploitation 103: The Power of Permissions"
date: 2026-01-18 00:00:00 +0800
categories: [Methodology]
tags: [linux, privilege escalation, post-exploitation, enumeration]
image: /assets/img/got-root.png
---

By the time you reach this stage, the easy wins are gone.

You've enumerated the system. You've poked at the environment. You've tried escaping the shell, abusing PATHs, and playing with wildcards. Maybe something worked. Maybe nothing did.

Eventually, every post-exploitation journey reaches the same moment:

> "I know what I want to do… but I don't have permission."

This is where Linux's permission model becomes either your greatest obstacle, or your greatest ally.

Linux doesn't hand out power randomly. It delegates it. And delegation, when done imperfectly, creates cracks.

This post is about finding those cracks.

## 1. The Holy Grail: Sudo Rights

The first command I run after stabilizing a shell is always the same:

```bash
sudo -l
```

This is Linux answering a very important question:

> "What do you trust me with?"

Sometimes the answer is catastrophic.

```
(ALL) NOPASSWD: ALL
```

That's not privilege escalation. That's an open door.

But most of the time, the list is shorter. Specific. Carefully chosen.

Or at least… it looks that way.

### Binary Abuse: When "Limited" Isn't Limited

Imagine you see this:

```
(root) NOPASSWD: /usr/sbin/tcpdump
```

At first glance, it feels harmless. Packet capture. Network stuff. Nothing scary.

But Linux binaries are rarely single-purpose tools. Many of them can execute other programs, read files, or write output in unexpected ways.

This is where [GTFOBins](https://gtfobins.github.io/) becomes your best friend.

For `tcpdump`, one feature stands out: the ability to execute a script after capture rotation.

```bash
# Create a simple payload
echo '/bin/sh -i' > /tmp/.shell.sh
chmod +x /tmp/.shell.sh

# Abuse tcpdump's post-rotate hook
sudo tcpdump -ln -i lo -w /dev/null -W 1 -G 1 -z /tmp/.shell.sh -Z root
```

No kernel exploits.  
No crashes.  
No noise.

Just a root shell handed to you by a tool the admin explicitly allowed.

## 2. SUID: Binaries with Superpowers

If sudo gives temporary power, SUID gives permanent power.

The Set User ID bit tells Linux:

> "No matter who runs this file, run it as the owner."

And when the owner is root, that's a big deal.

You can hunt for these binaries with:

```bash
find / -user root -perm -4000 -exec ls -ldb {} \; 2>/dev/null
```

Most of what you'll see is normal. Expected. Required for the system to function.

But every now and then, something feels… wrong.

A custom binary.  
A debugging tool.  
An editor.

### The Editor Problem

If you ever find something like this:

```
-rwsr-xr-x 1 root root ... /usr/bin/vim
```

That tiny `s` changes everything.

Editors aren't just file viewers. They execute commands. They spawn shells. They modify protected files.

With SUID Vim, you don't need clever tricks.

You can:

- Read `/etc/shadow`
- Modify `/etc/passwd`
- Spawn a root shell directly

At that point, the system already lost, it just hasn't realized it yet.

## 3. Capabilities: The Invisible Permissions

Modern Linux tried to fix the "all-or-nothing" root problem.

Instead of giving a binary full root privileges, it can be granted specific abilities, called **capabilities**.

Things like:

- `cap_net_raw` → sniff packets
- `cap_dac_override` → ignore file permissions
- `cap_setuid` → change user IDs

These don't show up in `ls -l`. They're silent.

To find them, you have to ask explicitly:

```bash
getcap -r / 2>/dev/null
```

### The Quietly Dangerous Capability

One of the most dangerous capabilities is:

```
cap_dac_override
```

It means: "Ignore file read/write permissions."

If you see something like:

```
/usr/bin/vim.basic = cap_dac_override+ep
```

You don't need sudo.  
You don't need SUID.

That binary can write anywhere.

You can use it to:

- Add a new UID 0 user to `/etc/passwd`
- Modify system configs
- Create a persistent backdoor

Capabilities are often added with good intentions.

They're also easy to forget, and devastating when misused.

## 4. Privileged Groups: Power by Association

Sometimes your user isn't special.

But your group is.

Run:

```bash
id
```

Then read the output carefully.

Some groups quietly bypass Linux's entire security model.

### The Usual Suspects

**docker / lxd:**  
If you can start containers, you can mount the host filesystem.  
From there, `/root/.ssh` is just another directory.

**disk:**  
Raw access to block devices.  
Tools like `debugfs` let you read any file, no permissions required.

**adm:**  
Full log access.  
And logs are full of mistakes: passwords, tokens, failed cron jobs, human error.

Groups are often added for convenience.

Attackers love convenience.

## Summary: Look for the Exception

At this level, privilege escalation isn't about breaking rules.

It's about finding where the rules were bent.

- One sudo exception
- One SUID binary
- One forgotten capability
- One overly helpful group

Linux is doing exactly what it was configured to do.

The problem is that humans did the configuring.

![got-root](/assets/img/got-root.png)

## What's Next?

In Part 4, the gloves come off. We'll dissect cron jobs, service misconfigurations, and internal daemons running as root. And when all legitimate paths are closed, we'll discuss kernel exploitation, not as a first move, but as a last, deliberate decision.
